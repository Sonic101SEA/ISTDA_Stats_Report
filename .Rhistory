# Equal variance
t.test(duration_use_success, duration_use_failure, var.equal = TRUE)
# Selecting duration use for successful
duration_use_success <- peermentor %>%
filter(rehab_success_factor == 1) %>%
select(duration_use)
# Selecting duration use for successful
duration_use_success <- peermentor %>%
filter(rehab_success_factor == "Yes") %>%
select(duration_use)
# Selecting duration use for unsuccessful
duration_use_failure <- peermentor %>%
filter(rehab_success_factor == "No") %>%
select(duration_use)
# 2 sample t-test to see difference
# Unequal variance
t.test(duration_use_success, duration_use_failure)
# Equal variance
t.test(duration_use_success, duration_use_failure, var.equal = TRUE)
# Analysis Aim 2: Logistic Regression -------------------------------------
peermentor_3 <- peermentor_2 %>%
filter(last_obs_outcome == "Study completed")
peermentor_3 <- peermentor_3 %>%
mutate(relapse_yes_no = ifelse(is.na(relapse_days), 0, 1)) # 0 = No relapse, 1 = relapse
peermentor_3 <- peermentor_3 %>%
filter(housing_status != "Other") %>%
mutate(housing_status_factor = as.factor(housing_status))
log_mod1 <- glm(data = peermentor_3, family = binomial(link = logit),
relapse_yes_no ~ age + gender_factor + injecting_status_factor +
housing_status_factor + rehab_success_factor)
summary(log_mod1)
log_mod1 <- glm(data = peermentor_3, family = binomial(link = logit),
relapse_yes_no ~ intervention_factor + age + gender_factor + injecting_status_factor +
housing_status_factor + rehab_success_factor)
summary(log_mod1)
log_mod1 <- glm(data = peermentor_3, family = binomial(link = logit),
relapse_yes_no ~ intervention_factor + age +
gender_factor + duration_use +
injecting_status_factor +
housing_status_factor + rehab_success_factor)
summary(log_mod1)
linear_model1 <- lm(data = peermentor_3, wellbeing1yr ~ intervention_factor +
age + gender_factor + duration_use +
injecting_status_factor +
housing_status_factor + rehab_success_factor)
summary(linear_model1)
table(intervention_factor)
table(peermentor_3$intervention_factor)
# Releveling
peermentor_3 <- peermentor_3 %>%
mutate(intervention_factor = relevel(intervention_factor, "standard of care"))
level(peermentor_3$intervention_factor)
# Releveling
peermentor_3 <- peermentor_3 %>%
mutate(intervention_factor = relevel(intervention_factor, "standard of care"))
peermentor_3 <- peermentor_3 %>%
mutate(injecting_status_factor = relevel(injecting_status_factor, "Never injected"))
peermentor_3 <- peermentor_3 %>%
mutate(housing_status_factor = relevel(housing_status_factor, "No problem"))
log_mod1 <- glm(data = peermentor_3, family = binomial(link = logit),
relapse_yes_no ~ intervention_factor + age +
gender_factor + duration_use +
injecting_status_factor +
housing_status_factor + rehab_success_factor)
summary(log_mod1)
linear_model1 <- lm(data = peermentor_3, wellbeing1yr ~ intervention_factor +
age + gender_factor + duration_use +
injecting_status_factor +
housing_status_factor + rehab_success_factor)
summary(linear_model1)
# Boxplot for rehab success and failure duration use
peermentor %>% ggplot(aes(x = rehab_success_factor, y = duration_use)) +
geom_boxplot(fill = c("red", "blue")) +
theme_minimal() + ggtitle("Boxplot showing duration use between rehab success and failure")
table(peermentor_3$housing_status_factor)
is.na(peermentor_3$wellbeing1yr)
table(is.na(peermentor_3$wellbeing1yr))
table(is.na(peermentor$wellbeing1yr))
linear_model1 <- lm(data = peermentor_2, wellbeing1yr ~ intervention_factor +
age + gender_factor + duration_use +
injecting_status_factor +
housing_status_factor + rehab_success_factor)
summary(linear_model1)
linear_model1 <- lm(data = peermentor_2, wellbeing1yr ~ intervention_factor +
age + gender_factor + duration_use +
injecting_status_factor +
housing_status_factor + rehab_success_factor)
linear_model1 <- lm(data = peermentor_3, wellbeing1yr ~ intervention_factor +
age + gender_factor + duration_use +
injecting_status_factor +
housing_status_factor + rehab_success_factor)
peermentor_4 <- peermentor_2 %>%
filter(is.na(wellbeing1yr))
peermentor_4 <- peermentor_2 %>%
filter(!is.na(wellbeing1yr))
peermentor_4 <- peermentor_4 %>%
filter(housing_status != "Other") %>%
mutate(housing_status_factor = as.factor(housing_status))
# Releveling
peermentor_4 <- peermentor_4 %>%
mutate(intervention_factor = relevel(intervention_factor, "standard of care"))
peermentor_4 <- peermentor_4 %>%
mutate(injecting_status_factor = relevel(injecting_status_factor, "Never injected"))
peermentor_4 <- peermentor_4 %>%
mutate(housing_status_factor = relevel(housing_status_factor, "No problem"))
linear_model1 <- lm(data = peermentor_3, wellbeing1yr ~ intervention_factor +
age + gender_factor + duration_use +
injecting_status_factor +
housing_status_factor + rehab_success_factor)
summary(linear_model1)
linear_model1 <- lm(data = peermentor_4, wellbeing1yr ~ intervention_factor +
age + gender_factor + duration_use +
injecting_status_factor +
housing_status_factor + rehab_success_factor)
summary(linear_model1)
linear_model1 <- lm(data = peermentor_4, wellbeing1yr ~ intervention_factor +
age + gender_factor + duration_use +
injecting_status_factor +
housing_status_factor)
summary(linear_model1)
plot(linear_model1)
par(mfrow = c(2,2))
plot(linear_model1)
# Libraries ---------------------------------------------------------------
library(dplyr)
library(ggplot2)
# Data --------------------------------------------------------------------
peermentor <- read.csv(here::here("data/peermentor.csv"))
View(peermentor)
# Libraries ---------------------------------------------------------------
library(dplyr)
library(ggplot2)
# Data --------------------------------------------------------------------
peermentor <- read.csv(here::here("data/peermentor.csv"))
# Data Processing ---------------------------------------------------------
peermentor <- peermentor %>%
# mutate(gender_factor = ifelse(gender == "male", 0, 1)) # Male = 0, Female = 1
mutate(gender_factor = as.factor(gender))
peermentor <- peermentor %>%
mutate(region_factor = as.factor(region))
peermentor <- peermentor %>%
# mutate(rehab_success_factor = ifelse(rehab_success == "No", 0, 1)) # No = 0, Yes = 1
mutate(rehab_success_factor = as.factor(rehab_success))
peermentor <- peermentor %>%
mutate(intervention_factor = as.factor(intervention))
# Analysis Aim 1: Chi-square testing ----------------------------------------------------------------
# Injecting Status and rehab_success
# Removing missing in injecting status
peermentor_2 <- peermentor %>%
filter(injecting_status != "Missing")
peermentor_2 <- peermentor_2 %>%
mutate(injecting_status_factor = as.factor(injecting_status))
# Chi-square test for rehab_success and injecting_status
chisq.test(table(peermentor_2$rehab_success_factor,
peermentor_2$injecting_status_factor))
# Selecting duration use for successful
duration_use_success <- peermentor %>%
filter(rehab_success_factor == "Yes") %>%
select(duration_use)
# Selecting duration use for unsuccessful
duration_use_failure <- peermentor %>%
filter(rehab_success_factor == "No") %>%
select(duration_use)
# Boxplot for rehab success and failure duration use
peermentor %>% ggplot(aes(x = rehab_success_factor, y = duration_use)) +
geom_boxplot(fill = c("red", "blue")) +
theme_minimal() + ggtitle("Boxplot showing duration use between rehab success and failure")
# 2 sample t-test to see difference
# Unequal variance
t.test(duration_use_success, duration_use_failure)
# Equal variance
t.test(duration_use_success, duration_use_failure, var.equal = TRUE)
# Analysis Aim 2: Logistic Regression -------------------------------------
# Filtering missing data
peermentor_3 <- peermentor_2 %>%
filter(last_obs_outcome == "Study completed")
peermentor_3 <- peermentor_3 %>%
mutate(relapse_yes_no = ifelse(is.na(relapse_days), 0, 1)) # 0 = No relapse, 1 = relapse
peermentor_3 <- peermentor_3 %>%
filter(housing_status != "Other") %>%
mutate(housing_status_factor = as.factor(housing_status))
# Releveling
peermentor_3 <- peermentor_3 %>%
mutate(intervention_factor = relevel(intervention_factor, "standard of care"))
peermentor_3 <- peermentor_3 %>%
mutate(injecting_status_factor = relevel(injecting_status_factor, "Never injected"))
peermentor_3 <- peermentor_3 %>%
mutate(housing_status_factor = relevel(housing_status_factor, "No problem"))
# Logistic Regression Model
log_mod1 <- glm(data = peermentor_3, family = binomial(link = logit),
relapse_yes_no ~ intervention_factor + age +
gender_factor + duration_use +
injecting_status_factor +
housing_status_factor + rehab_success_factor)
summary(log_mod1)
# Analysis Aim 3: Linear Regression ---------------------------------------
# Filtering out NA in wellbeing1yr
peermentor_4 <- peermentor_2 %>%
filter(!is.na(wellbeing1yr))
peermentor_4 <- peermentor_4 %>%
filter(housing_status != "Other") %>%
mutate(housing_status_factor = as.factor(housing_status))
# Releveling
peermentor_4 <- peermentor_4 %>%
mutate(intervention_factor = relevel(intervention_factor, "standard of care"))
peermentor_4 <- peermentor_4 %>%
mutate(injecting_status_factor = relevel(injecting_status_factor, "Never injected"))
peermentor_4 <- peermentor_4 %>%
mutate(housing_status_factor = relevel(housing_status_factor, "No problem"))
# Linear model
linear_model1 <- lm(data = peermentor_4, wellbeing1yr ~ intervention_factor +
age + gender_factor + duration_use +
injecting_status_factor +
housing_status_factor + rehab_success_factor)
summary(linear_model1)
# Checking linear model assumptions
par(mfrow = c(2,2))
plot(linear_model1)
View(duration_use_failure)
View(duration_use_success)
View(peermentor_3)
# Libraries ---------------------------------------------------------------
library(dplyr)
library(ggplot2)
# Data --------------------------------------------------------------------
peermentor <- read.csv(here::here("data/peermentor.csv"))
peermentor <- peermentor %>%
# mutate(gender_factor = ifelse(gender == "male", 0, 1)) # Male = 0, Female = 1
mutate(gender_factor = as.factor(gender))
peermentor <- peermentor %>%
mutate(region_factor = as.factor(region))
peermentor <- peermentor %>%
# mutate(rehab_success_factor = ifelse(rehab_success == "No", 0, 1)) # No = 0, Yes = 1
mutate(rehab_success_factor = as.factor(rehab_success))
peermentor <- peermentor %>%
mutate(intervention_factor = as.factor(intervention))
# Analysis Aim 1: Chi-square testing ----------------------------------------------------------------
# Injecting Status and rehab_success
# Removing missing in injecting status
peermentor_2 <- peermentor %>%
filter(injecting_status != "Missing")
peermentor_2 <- peermentor_2 %>%
mutate(injecting_status_factor = as.factor(injecting_status))
# Chi-square test for rehab_success and injecting_status
chisq.test(table(peermentor_2$rehab_success_factor,
peermentor_2$injecting_status_factor))
# Selecting duration use for successful
duration_use_success <- peermentor %>%
filter(rehab_success_factor == "Yes") %>%
select(duration_use)
# Selecting duration use for unsuccessful
duration_use_failure <- peermentor %>%
filter(rehab_success_factor == "No") %>%
select(duration_use)
# Boxplot for rehab success and failure duration use
peermentor %>% ggplot(aes(x = rehab_success_factor, y = duration_use)) +
geom_boxplot(fill = c("red", "blue")) +
theme_minimal() + ggtitle("Boxplot showing duration use between rehab success and failure")
# 2 sample t-test to see difference
# Unequal variance
t.test(duration_use_success, duration_use_failure)
# Equal variance
t.test(duration_use_success, duration_use_failure, var.equal = TRUE)
# Analysis Aim 2: Logistic Regression -------------------------------------
# Filtering missing data
peermentor_3 <- peermentor_2 %>%
filter(last_obs_outcome == "Study completed")
peermentor_3 <- peermentor_3 %>%
mutate(relapse_yes_no = ifelse(is.na(relapse_days), 0, 1)) # 0 = No relapse, 1 = relapse
peermentor_3 <- peermentor_3 %>%
filter(housing_status != "Other") %>%
mutate(housing_status_factor = as.factor(housing_status))
# Releveling
peermentor_3 <- peermentor_3 %>%
mutate(intervention_factor = relevel(intervention_factor, "standard of care"))
peermentor_3 <- peermentor_3 %>%
mutate(injecting_status_factor = relevel(injecting_status_factor, "Never injected"))
relevel
peermentor_3 <- peermentor_3 %>%
mutate(housing_status_factor = relevel(housing_status_factor, "No problem"))
# Logistic Regression Model
log_mod1 <- glm(data = peermentor_3, family = binomial(link = logit),
relapse_yes_no ~ intervention_factor + age +
gender_factor + duration_use +
injecting_status_factor +
housing_status_factor + rehab_success_factor)
summary(log_mod1)
# Analysis Aim 3: Linear Regression ---------------------------------------
# Filtering out NA in wellbeing1yr
peermentor_4 <- peermentor_2 %>%
filter(!is.na(wellbeing1yr))
peermentor_4 <- peermentor_4 %>%
filter(housing_status != "Other") %>%
mutate(housing_status_factor = as.factor(housing_status))
# Releveling
peermentor_4 <- peermentor_4 %>%
mutate(intervention_factor = relevel(intervention_factor, "standard of care"))
peermentor_4 <- peermentor_4 %>%
mutate(injecting_status_factor = relevel(injecting_status_factor, "Never injected"))
peermentor_4 <- peermentor_4 %>%
mutate(housing_status_factor = relevel(housing_status_factor, "No problem"))
# Linear model
linear_model1 <- lm(data = peermentor_4, wellbeing1yr ~ intervention_factor +
age + gender_factor + duration_use +
injecting_status_factor +
housing_status_factor + rehab_success_factor)
summary(linear_model1)
linear_model2 <- lm(data = peermentor_4, wellbeing1yr ~ intervention_factor +
age + gender_factor + duration_use +
injecting_status_factor +
housing_status_factor)
summary(linear_model2)
linear_model3 <- lm(data = peermentor_4, wellbeing1yr ~ intervention_factor +
age + gender_factor +
housing_status_factor + rehab_success_factor)
summary(linear_model3)
summary(log_mod2)
log_mod2 <- glm(data = peermentor_3, family = binomial(link = logit),
relapse_yes_no ~ intervention_factor + age +
gender_factor + duration_use +
injecting_status_factor +
housing_status_factor)
summary(log_mod2)
summary(log_mod1)
log_mod3 <- glm(data = peermentor_3, family = binomial(link = logit),
relapse_yes_no ~ intervention_factor + age +
gender_factor + duration_use +
rehab_success_factor)
summary(log_mod3)
log_mod3 <- glm(data = peermentor_3, family = binomial(link = logit),
relapse_yes_no ~ intervention_factor + age +
gender_factor +
rehab_success_factor + housing_status_factor)
summary(log_mod3)
car::vif(lienar_model1)
car::vif(linear_model1)
car::vif(log_mod1)
# Equal variance
t.test(duration_use_success, duration_use_failure, var.equal = TRUE)
linear_model4 <- lm(data = peermentor_4, wellbeing1yr ~ intervention_factor +
age + gender_factor + duration_use *
injecting_status_factor +
housing_status_factor + rehab_success_factor)
summary(linear_model4)
# Libraries ---------------------------------------------------------------
library(dplyr)
library(ggplot2)
# Data --------------------------------------------------------------------
peermentor <- read.csv(here::here("data/peermentor.csv"))
peermentor <- peermentor %>%
# mutate(gender_factor = ifelse(gender == "male", 0, 1)) # Male = 0, Female = 1
mutate(gender_factor = as.factor(gender))
peermentor <- peermentor %>%
mutate(region_factor = as.factor(region))
peermentor <- peermentor %>%
# mutate(rehab_success_factor = ifelse(rehab_success == "No", 0, 1)) # No = 0, Yes = 1
mutate(rehab_success_factor = as.factor(rehab_success))
peermentor <- peermentor %>%
mutate(intervention_factor = as.factor(intervention))
# Analysis Aim 1: Chi-square testing ----------------------------------------------------------------
# Injecting Status and rehab_success
# Removing missing in injecting status
peermentor_2 <- peermentor %>%
filter(injecting_status != "Missing")
peermentor_2 <- peermentor_2 %>%
mutate(injecting_status_factor = as.factor(injecting_status))
# Chi-square test for rehab_success and injecting_status
chisq.test(table(peermentor_2$rehab_success_factor,
peermentor_2$injecting_status_factor))
# Selecting duration use for successful
duration_use_success <- peermentor %>%
filter(rehab_success_factor == "Yes") %>%
select(duration_use)
# Selecting duration use for unsuccessful
duration_use_failure <- peermentor %>%
filter(rehab_success_factor == "No") %>%
select(duration_use)
# Boxplot for rehab success and failure duration use
peermentor %>% ggplot(aes(x = rehab_success_factor, y = duration_use)) +
geom_boxplot(fill = c("red", "blue")) +
theme_minimal() + ggtitle("Boxplot showing duration use between rehab success and failure")
# 2 sample t-test to see difference
# Unequal variance
t.test(duration_use_success, duration_use_failure)
# Equal variance
t.test(duration_use_success, duration_use_failure, var.equal = TRUE)
# Analysis Aim 2: Logistic Regression -------------------------------------
# Filtering missing data
peermentor_3 <- peermentor_2 %>%
filter(last_obs_outcome == "Study completed")
peermentor_3 <- peermentor_3 %>%
mutate(relapse_yes_no = ifelse(is.na(relapse_days), 0, 1)) # 0 = No relapse, 1 = relapse
peermentor_3 <- peermentor_3 %>%
filter(housing_status != "Other") %>%
mutate(housing_status_factor = as.factor(housing_status))
# Releveling
peermentor_3 <- peermentor_3 %>%
mutate(intervention_factor = relevel(intervention_factor, "standard of care"))
peermentor_3 <- peermentor_3 %>%
mutate(injecting_status_factor = relevel(injecting_status_factor, "Never injected"))
peermentor_3 <- peermentor_3 %>%
mutate(housing_status_factor = relevel(housing_status_factor, "No problem"))
table(peermentor_3$intervention_factor)
# Analysis Aim 3: Linear Regression ---------------------------------------
# Filtering out NA in wellbeing1yr
peermentor_4 <- peermentor_2 %>%
filter(!is.na(wellbeing1yr))
peermentor_4 <- peermentor_4 %>%
filter(housing_status != "Other") %>%
mutate(housing_status_factor = as.factor(housing_status))
intervention_factor
# Releveling
peermentor_4 <- peermentor_4 %>%
mutate(intervention_factor = relevel(intervention_factor, "standard of care"))
peermentor_4 <- peermentor_4 %>%
mutate(injecting_status_factor = relevel(injecting_status_factor, "Never injected"))
peermentor_4 <- peermentor_4 %>%
mutate(housing_status_factor = relevel(housing_status_factor, "No problem"))
# Linear model
linear_model1 <- lm(data = peermentor_4, wellbeing1yr ~ intervention_factor +
age + gender_factor + duration_use +
injecting_status_factor +
housing_status_factor + rehab_success_factor)
table(peermentor_4$intervention_factor)
View(peermentor)
table(peermentor$gender_factor)
table(peermentor$injecting_status)
# Interaction with intervention and gender/injecting status
linear_model5 <- lm(data = peermentor_4, wellbeing1yr ~  age + duration_use +
housing_status_factor + rehab_success_factor +
intervention_factor * gender_factor * injecting_status_factor)
summary(linear_model5)
# Interaction with intervention and gender/injecting status
linear_model5 <- lm(data = peermentor_4, wellbeing1yr ~  age + duration_use +
housing_status_factor + rehab_success_factor +
intervention_factor * gender_factor * injecting_status_factor)
summary(linear_model5)
summary(linear_model5)
# Interaction with intervention and gender/injecting status
linear_model5 <- lm(data = peermentor_4, wellbeing1yr ~  age + duration_use +
housing_status_factor + rehab_success_factor +
intervention_factor + gender_factor + injecting_status_factor +
intervention_factor : gender_factor)
summary(linear_model5)
# Interaction with intervention and gender/injecting status
linear_model5 <- lm(data = peermentor_4, wellbeing1yr ~  age + duration_use +
housing_status_factor + rehab_success_factor +
intervention_factor + gender_factor + injecting_status_factor +
intervention_factor : gender_factor + intervention_factor : injecting_status_factor)
summary(linear_model5)
# Including interaction term
log_mod4 <- glm(data = peermentor_3, family = binomial(link = logit),
relapse_yes_no ~age + duration_use +
housing_status_factor + rehab_success_factor +
intervention_factor + gender_factor + injecting_status_factor
intervention_factor : gender_factor + intervention_factor : injecting_status_factor)
# Including interaction term
log_mod4 <- glm(data = peermentor_3, family = binomial(link = logit),
relapse_yes_no ~age + duration_use +
housing_status_factor + rehab_success_factor +
intervention_factor + gender_factor + injecting_status_factor +
intervention_factor : gender_factor + intervention_factor : injecting_status_factor)
summary(log_mod4)
summary(linear_model1)
confint(linear_model1)
confint(log_mod1)
# Logistic Regression Model
log_mod1 <- glm(data = peermentor_3, family = binomial(link = logit),
relapse_yes_no ~ intervention_factor + age +
gender_factor + duration_use +
injecting_status_factor +
housing_status_factor + rehab_success_factor)
confint(log_mod1)
table(peermentor$age)
table(is.na(peermentor$age))
table(is.na(peermentor$gender))
table(peermentor$last_study_obs)
# 2 sample t-test to see difference
# Unequal variance
t.test(duration_use_success, duration_use_failure)
summary(duration_use_success)
sd(duration_use_success)
sd(duration_use_success$duration_use)
mean(duration_use_success$duration_use)
sd(duration_use_failure$duration_use)
summ(linear_model1)
install.packages("jtools")
jtools :: summ(linear_model1)
jtools :: export_summs(linear_model1, scale = TRUE)
install.packages("huxtable")
jtools :: export_summs(linear_model1, scale = TRUE)
install.packages("officer")
install.packages("flextable")
jtools :: export_summs(linear_model1, scale = TRUE, to.file = "docx", file.name = "test.docx")
table1(linear_model1)
jtools :: summ(linear_model1, confint = TRUE)
jtools :: summ(linear_model1, confint = TRUE, digits = 3)
jtools :: summ(linear_model1, confint = TRUE, digits = 4)
jtools :: summ(linear_model1, confint = TRUE, digits = 5)
summary(linear_model1)
View(peermentor_4)
install.packages("tableone")
tableone :: CreateTableOne(data = peermentor)
install.packages("stargazer")
stargazer :: stargazer(linear_model1, type = "html", out = "linear_model_base.html")
table1(peermentor)
install.packages("table1")
table1 :: table1(peermentor)
tableone(peermentor)
tableone :: tableone(peermentor)
tableone :: CreateTableOne(data = peermentor)
jtools :: summ(linear_model1, confint = TRUE, digits = 5)
